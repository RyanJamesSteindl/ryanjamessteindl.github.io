<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Victron Mapped Dashboard - DIAGNOSTIC</title>
    <style>
        /* Minimal and high-contrast styles */
        :root { --bg: #000; --card-bg: #1e1e1e; --text: #f0f0f0; --accent: #00d2ff; --danger: #ff4444; --success: #00c851; --warning: #ffbb33; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg); color: var(--text); margin: 0; padding: 20px; }
        
        /* Status/Version Header */
        #headerStatus { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 10px; border-bottom: 1px solid #333;}
        #status { font-weight: bold; color: var(--text); font-size: 1.1rem; }
        .version-tag { font-size: 0.85rem; color: var(--accent); background: #111; padding: 4px 8px; border-radius: 4px; border: 1px solid var(--accent); }

        .diagnostic-box { background: #333; padding: 20px; border-radius: 8px; text-align: center; margin-top: 30px; }
        .diagnostic-box h2 { color: var(--danger); }
    </style>
</head>
<body>

    <div id="headerStatus">
        <!-- Main Status Message - Initial state is PENDING, must be updated by JS -->
        <div id="status" style="color:var(--warning);">JS CHECK: PENDING (v5.0.0)</div>
        <!-- HARD-CODED Version Display -->
        <div class="version-tag">v5.0.0</div>
    </div>
    
    <div id="connectionPanel">
        <input type="text" id="keyInput" placeholder="Paste 32-char Encryption Key" style="width:100%;" />
        <button id="connectBtn" style="background-color: var(--accent); color: #000;" 
                onclick="alert('JavaScript is still blocked. Connection logic cannot run.'); return false;">
            Connect (JS Blocked)
        </button>
        <div style="text-align:center; font-size:0.8rem; color:#555; margin-top: 10px;">
            If this button shows an alert, JS is partially working. If nothing happens, it is fully blocked.
        </div>
    </div>

    <div class="diagnostic-box">
        <h2>Execution Environment Failure</h2>
        <p style="color:var(--text);">
            If the status above is **PENDING**, the hosting environment (iframe/sandbox) is preventing the core JavaScript code from running, which is required for Web Bluetooth and device decryption.
        </p>
        <p style="color:var(--warning); font-size: 0.9rem;">
            **Workaround:** Please try copying the contents of this file and running it directly in a standalone Chrome browser on an Android device (via a hosted service like GitHub Pages or a local server) to bypass the platform's security restrictions.
        </p>
    </div>

<script>
    // --- FINAL ATTEMPT AT SYNCHRONOUS JS EXECUTION ---
    const APP_VERSION = "5.0.0";
    const statusEl = document.getElementById('status');

    // This code runs immediately when the <script> tag is parsed.
    if (statusEl) {
        statusEl.innerText = `JS CHECK: OK (v${APP_VERSION})`;
        statusEl.style.color = 'var(--success)';
        statusEl.style.fontSize = '1.2rem';
    } else {
        // Fallback for extreme paranoia, unlikely to ever execute
        console.error("Status element not found.");
    }

    // Since connection is impossible, we remove the complex functions entirely
    // and rely on the synchronous check above to prove JS is running.
</script>
</body>
</html>

